<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kling AI Motion Control</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <header>
            <h1>🎬 AI Acting Studio</h1>
            <p>이미지와 영상을 조합하여 새로운 영상을 만들고, AI 목소리를 입혀보세요.</p>
        </header>


        <div class="card">
            <h2>새 비디오 생성</h2>

            <div class="form-group">
                <label>이미지</label>
                <div class="tabs">
                    <button class="tab-btn active" data-tab="imageUrl">URL 입력</button>
                    <button class="tab-btn" data-tab="imageFile">파일 업로드</button>
                </div>
                <div id="imageUrl-content" class="tab-content active">
                    <input type="text" id="imageUrl" placeholder="https://example.com/image.jpg" />
                    <small>JPG/PNG, 10MB 이하, 300px-65536px</small>
                </div>
                <div id="imageFile-content" class="tab-content">
                    <input type="file" id="imageFile" accept="image/jpeg,image/png" />
                    <small>JPG/PNG, 10MB 이하, 300px-65536px</small>
                    <div id="imagePreview" class="preview"></div>
                </div>
            </div>

            <div class="form-group">
                <label for="videoUrl">참조 비디오 URL</label>
                <input type="text" id="videoUrl" placeholder="https://example.com/video.mp4" />
                <small>⚠️ 직접 다운로드 가능한 .mp4 또는 .mov 파일 URL 필요</small>

                <details class="help-guide">
                    <summary>❓ 올바른 비디오 URL을 얻는 방법</summary>
                    <div class="guide-content">
                        <p>Kling AI는 <strong>직접 다운로드 가능한 비디오 파일(.mp4, .mov)의 URL</strong>만 지원합니다. (YouTube, Google Drive
                            공유 링크 불가)</p>

                        <h4>방법 1: 임시 파일 호스팅 사용 (추천)</h4>
                        <ol>
                            <li><a href="https://tmpfiles.org/" target="_blank">tmpfiles.org</a> 접속</li>
                            <li>비디오 파일 업로드</li>
                            <li>생성된 페이지에서 <strong>"Direct Link"</strong> 우클릭 후 복사</li>
                        </ol>

                        <h4>방법 2: Discord 사용</h4>
                        <ol>
                            <li>Discord 채팅방에 비디오 파일을 드래그해서 업로드</li>
                            <li>업로드된 비디오 우클릭 > <strong>"링크 복사"</strong> 선택</li>
                            <li>복사된 링크 끝이 <code>.mp4</code> 또는 <code>.mov</code>인지 확인</li>
                        </ol>

                        <h4>방법 3: 개인 서버/CDN</h4>
                        <p>직접 운영하는 웹 서버나 AWS S3 등에 파일을 올리고 공개 URL 사용</p>
                    </div>
                </details>
            </div>

            <div class="form-group">
                <label for="orientation">캐릭터 방향</label>
                <select id="orientation">
                    <option value="image">이미지 방향 (최대 10초)</option>
                    <option value="video">비디오 방향 (최대 30초)</option>
                </select>
            </div>

            <button id="generateBtn" class="btn-primary">비디오 생성하기</button>
        </div>

        <div class="card voice-card">
            <h2>🎙️ AI 목소리 서비스 (ElevenLabs)</h2>
            <div class="tabs">
                <button class="tab-btn active" data-tab="voiceGen">텍스트 → 음성 (TTS)</button>
                <button class="tab-btn" data-tab="voiceChange">음성 → 음성 (STS)</button>
                <button class="tab-btn" data-tab="voiceClone">내 목소리 등록</button>
            </div>

            <div id="voiceGen-content" class="tab-content active">
                <div class="form-group">
                    <label>텍스트 입력</label>
                    <textarea id="voiceText" rows="3" placeholder="목소리로 변환할 텍스트를 입력하세요"></textarea>
                </div>
                <button id="generateVoiceBtn" class="btn-primary">목소리 생성하기</button>
            </div>

            <div id="voiceChange-content" class="tab-content">
                <div class="form-group">
                    <label>음성 입력 방식</label>
                    <div class="input-methods">
                        <label><input type="radio" name="audioInputMethod" value="upload" checked> 파일 업로드</label>
                        <label><input type="radio" name="audioInputMethod" value="record"> 직접 녹음</label>
                    </div>
                </div>

                <div id="method-upload" class="method-content active">
                    <div class="form-group">
                        <label>녹음된 목소리 업로드</label>
                        <input type="file" id="voiceInputFile" accept="audio/*">
                        <small>본인의 목소리나 변형하고 싶은 오디오 파일을 업로드하세요.</small>
                    </div>
                </div>

                <div id="method-record" class="method-content">
                    <div class="form-group">
                        <label>직접 녹음하기</label>
                        <div class="record-controls">
                            <button id="startRecordBtn" class="btn-record">⏺️ 녹음 시작</button>
                            <button id="stopRecordBtn" class="btn-stop" disabled>⏹️ 녹음 중지</button>
                            <span id="recordTimer" class="timer">00:00</span>
                        </div>
                        <div id="recordingPulse" class="pulse" style="display: none;"></div>
                    </div>
                </div>

                <button id="convertVoiceBtn" class="btn-primary">목소리 변형하기</button>
            </div>

            <div id="voiceClone-content" class="tab-content">
                <div class="form-group">
                    <label>목소리 이름</label>
                    <input type="text" id="voiceCloneName" placeholder="예: 내 목소리">
                </div>
                <div class="form-group">
                    <label>목소리 샘플 (1-5분 권장)</label>
                    <div class="input-methods">
                        <label><input type="radio" name="cloneInputMethod" value="upload" checked> 파일 업로드</label>
                        <label><input type="radio" name="cloneInputMethod" value="record"> 직접 녹음</label>
                    </div>
                </div>
                <div id="clone-method-upload" class="method-content active">
                    <input type="file" id="voiceCloneFile" accept="audio/*">
                </div>
                <div id="clone-method-record" class="method-content">
                    <div class="record-controls">
                        <button id="cloneStartRecordBtn" class="btn-record">⏺️ 녹음 시작</button>
                        <button id="cloneStopRecordBtn" class="btn-stop" disabled>⏹️ 녹음 중지</button>
                        <span id="cloneRecordTimer" class="timer">00:00</span>
                    </div>
                    <div id="cloneRecordingPulse" class="pulse" style="display: none;"></div>
                    <audio id="clonePreview" controls style="width: 100%; margin-top: 10px; display: none;"></audio>
                </div>
                <div class="form-group" style="margin-top: 10px;">
                    <label><input type="checkbox" id="removeNoiseCheckbox" checked> 배경 소음 제거</label>
                </div>
                <button id="createVoiceBtn" class="btn-primary">내 목소리 등록하기</button>
                <div id="voiceCloneStatus" style="margin-top: 10px;"></div>
            </div>

            <div class="form-group" style="margin-top: 15px;">
                <label>목소리 선택</label>
                <div style="display: flex; gap: 10px;">
                    <select id="elevenVoiceSelect" style="flex: 1;">
                        <option value="21m00Tcm4TlvDq8ikWAM">Rachel (기본)</option>
                    </select>
                    <button id="loadVoicesBtn" class="btn-secondary">목록 새로고침</button>
                </div>
            </div>

            <div id="voicePreviewSection" style="margin-top: 15px; display: none;">
                <audio id="voicePreview" controls style="width: 100%;"></audio>
                <div style="display: flex; gap: 10px; margin-top: 10px;">
                    <button id="downloadVoiceBtn" class="btn-secondary" style="flex: 1;">녹음 파일 다운로드</button>
                </div>
            </div>
        </div>

        <div id="resultSection" class="card" style="display: none;">
            <h2>결과</h2>
            <div id="resultContent"></div>
        </div>

        <div id="taskListSection" class="card">
            <h2>작업 목록</h2>
            <button id="refreshBtn" class="btn-secondary">새로고침</button>
            <div id="taskList"></div>
        </div>
    </div>

    <script type="module" src="script.js"></script>
</body>

</html>